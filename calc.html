<!doctype html>
<html>

  <head lang="ru">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta charset="utf-8" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/7.0.0/normalize.min.css" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <link rel="stylesheet" href="custom.css" </head>

    <body>
      <h1>Калькулятор за май</h1>
      <form>
        <div class="form-group">
          <label for="exampleInputEmail1">Сколько дней</label>
          <input type="text" class="form-control" id="CountDays" placeholder="Количество дней" value="24">
        </div>
        <div class="form-group">
          <label for="exampleInputEmail1">Из скольки дней</label>
          <input type="text" class="form-control" id="TotalDays" placeholder="Количество дней" value="31">
        </div>
        <div class="panel panel-default">
          <div class="panel-heading">В месяц</div>
          <div class="panel-body">
            <table class="table">
              <tr>
                <th>
                  Что
                </th>
                <th>
                  Сколько в день
                </th>
              </tr>
              <tr>
                <td>
                  Отопление
                </td>
                <td>
                  <input type="text" class="form-control" id="Heating" value="1063.14" readonly="readonly">
                </td>
              </tr>
              <tr>
                <td>
                  Содержание и ремонт
                </td>
                <td>
                  <input type="text" class="form-control" id="Maintaining" value="1179.68" readonly="readonly">
                </td>
              </tr>
              <tr>
                <td>
                  Электроснабжение ОДН
                </td>
                <td>
                  <input type="text" class="form-control" id="CommonElectricity" value="95.53" readonly="readonly">
                </td>
              </tr>
            </table>
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading">В месяц переменные</div>
          <div class="panel-body">
            <table class="table">
              <tr>
                <th>
                  Что
                </th>
                <th>
                  Тариф
                </th>
                <th>
                  Было
                </th>
                <th>
                  Стало
                </th>
                <th>
                  Разница
                </th>
              </tr>
              <tr>
                <td>
                  Холодное водоснабжение
                </td>
                <td>
                  34,57
                </td>
                <td>
                  <input type="text" class="form-control" id="ColdWaterPrevious" value="15.92">
                </td>
                <td>
                  <input type="text" class="form-control" id="ColdWaterNow" value="15.92">
                </td>
                <td>
                  <input type="text" class="form-control" id="ColdWaterDiff" value="0" readonly="readonly">
                </td>
              </tr>
              <tr>
                <td>
                  Холодное водоснабжение для ГВС
                </td>
                <td>
                  34,57
                </td>
                <td>
                  <input type="text" class="form-control" id="ColdWaterHotPrevious" value="6.65">
                </td>
                <td>
                  <input type="text" class="form-control" id="ColdWaterHotNow" value="6.65">
                </td>
                <td>
                  <input type="text" class="form-control" id="ColdWaterHotDiff" value="0" readonly="readonly">
                </td>
              </tr>
              <tr>
                <td>
                  Подогрев
                </td>
                <td>
                  121,83
                </td>
                <td>

                </td>
                <td>

                </td>
                <td>
                  <input type="text" class="form-control" id="HeatUpDiff" value="0" readonly="readonly">
                </td>
              </tr>
              <tr>
                <td>
                  Водоотведение
                </td>
                <td>
                  29,24
                </td>
                <td>

                </td>
                <td>

                </td>
                <td>
                  <input type="text" class="form-control" id="WaterOutDiff" value="0" readonly="readonly">
                </td>
              </tr>
              <tr>
                <td>
                  Электроснабжение: день
                </td>
                <td>
                  3,87
                </td>
                <td>
                  <input type="text" class="form-control" id="ElectricityDayPrevious" value="177.40">
                </td>
                <td>
                  <input type="text" class="form-control" id="ElectricityDayNow" value="177.40">
                </td>
                <td>
                  <input type="text" class="form-control" id="ElectricityDayDiff" value="0" readonly="readonly">
                </td>
              </tr>
              <tr>
                <td>
                  Электроснабжение: ночь
                </td>
                <td>
                  1,37
                </td>
                <td>
                  <input type="text" class="form-control" id="ElectricityNightPrevious" value="35.78">
                </td>
                <td>
                  <input type="text" class="form-control" id="ElectricityNightNow" value="35.78">
                </td>
                <td>
                  <input type="text" class="form-control" id="ElectricityNightDiff" value="0" readonly="readonly">
                </td>
              </tr>
            </table>
          </div>
        </div>
        <div class="form-group">
          <label for="exampleInputEmail1">Сумма всего</label>
          <input type="text" class="form-control" id="Total" value="0">
        </div>
      </form>
      <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
      <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
      <script>
      $('#CountDays').change(calc);
      $('#TotalDays').change(calc);
      $('#ColdWaterPrevious').change(coldWater);
      $('#ColdWaterNow').change(coldWater);
      $('#ColdWaterHotPrevious').change(coldWaterHot);
      $('#ColdWaterHotNow').change(coldWaterHot);
      $('#ElectricityDayPrevious').change(electricityDay);
      $('#ElectricityDayNow').change(electricityDay);
      $('#ElectricityNightPrevious').change(electricityNight);
      $('#ElectricityNightNow').change(electricityNight);

      function coldWater(){
        var diff = +($('#ColdWaterNow').val()) - +($('#ColdWaterPrevious').val());
        $('#ColdWaterDiff').val(diff);
        waterOut();
        calc();
      }
      function coldWaterHot(){
        var diff = +($('#ColdWaterHotNow').val()) - +($('#ColdWaterHotPrevious').val());
        $('#ColdWaterHotDiff').val(diff);
        $('#HeatUpDiff').val(diff);
        waterOut();
        calc();
      }
      function heatUp(){
        var diff = +($('#HeatUpNow').val()) - +($('#HeatUpPrevious').val());
        $('#HeatUpDiff').val(diff);
        calc();
      }
      function waterOut(){
        var sum = +($('#ColdWaterHotDiff').val()) + +($('#ColdWaterDiff').val());
        $('#WaterOutDiff').val(sum);
        calc();
      }
      function electricityDay(){
        var diff = +($('#ElectricityDayNow').val()) - +($('#ElectricityDayPrevious').val());
        $('#ElectricityDayDiff').val(diff);
        calc();
      }
      function electricityNight(){
        var diff = +($('#ElectricityNightNow').val()) - +($('#ElectricityNightPrevious').val());
        $('#ElectricityNightDiff').val(diff);
        calc();
      }


      //function calc() {
      function calc() {
        var coeff = +($('#CountDays').val()) / +($('#TotalDays').val());
        var heating = +($('#Heating').val());
        var maintaining = +($('#Maintaining').val());
        var commonElectricity = +($('#CommonElectricity').val());
        var coldWater = 34.57 * $('#ColdWaterDiff').val();
        var coldWaterHot = 34.57 * $('#ColdWaterHotDiff').val();
        var heatUp = 121.83 * $('#HeatUpDiff').val();
        var outWater = 29.24 * $('#WaterOutDiff').val();
        var elDay = 3.87  * $('#ElectricityDayDiff').val();
        var elNight = 3.87  * $('#ElectricityNightDiff').val();

        $('#Total').val((heating + maintaining + commonElectricity + coldWater + coldWaterHot + heatUp + outWater + elDay + elNight) * coeff);
      }

      calc();

      </script>
    </body>

</html>
